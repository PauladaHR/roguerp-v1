-----------------------------------------------------------------------------------------------------------------------------------------
-- VRP
-----------------------------------------------------------------------------------------------------------------------------------------
local Tunnel = module("vrp","lib/Tunnel")
local Proxy = module("vrp","lib/Proxy")
vRP = Proxy.getInterface("vRP")
-----------------------------------------------------------------------------------------------------------------------------------------
-- CONNECTION
-----------------------------------------------------------------------------------------------------------------------------------------
hRP = {}
Tunnel.bindInterface("vrp_register",hRP)
vSERVER = Tunnel.getInterface("vrp_register")
-----------------------------------------------------------------------------------------------------------------------------------------
-- VARS
-----------------------------------------------------------------------------------------------------------------------------------------
local registers = {
	{ 24.91,-1347.77,29.49,260.79 },
	{ 24.9,-1345.67,29.49,263.63 },
	{ 2555.66,381.22,108.61,2.84 },
	{ 2557.79,381.14,108.61,351.5 },
	{ 1165.06,-324.48,69.2,158.75 },
	{ 1164.73,-322.6,69.2,93.55 },
	{ -706.07,-915.41,19.21,141.74 },
	{ -706.07,-913.37,19.21,79.38 },
	{ -47.86,-1759.35,29.42,113.39 },
	{ -46.58,-1757.84,29.42,42.52 },
	{ 372.84,325.81,103.56,272.13 },
	{ 373.34,327.82,103.56,257.96 },
	{ -3241.67,1000.29,12.82,348.67 },
	{ -3243.77,1000.54,12.82,0.0 },
	{ 1728.02,6414.56,35.03,238.12 },
	{ 1728.86,6416.44,35.03,289.14 },
	{ 1960.67,3739.67,32.33,297.64 },
	{ 1959.7,3741.54,32.33,297.64 },
	{ 2678.8,3279.49,55.23,325.99 },
	{ 2676.78,3280.5,55.23,14.18 },
	{ 1696.57,4923.88,42.06,25.52 },
	{ 1698.22,4922.87,42.06,311.82 },
	{ -1820.1,794.26,138.08,70.87 },
	{ -1818.89,792.94,138.07,195.6 },
	{ 1392.89,3606.45,34.98,184.26 },
	{ -2966.45,390.9,15.05,79.38 },
	{ -3038.66,584.99,7.9,5.67 },
	{ -3040.61,584.38,7.9,14.18 },
	{ 1134.14,-982.44,46.4,280.63 },
	{ 1165.76,2710.77,38.15,167.25 },
	{ -1486.19,-378.03,40.15,127.56 },
	{ -1221.95,-908.32,12.32,34.02 },
	{ 78.36,-1388.9,29.37,170.08 },
	{ 81.84,-1388.9,29.37,181.42 },
	{ -706.68,-151.31,37.41,119.06 },
	{ -166.79,-301.58,39.73,246.62 },
	{ -817.39,-1074.05,11.32,144.57 },
	{ -815.64,-1077.08,11.32,155.91 },
	{ -1198.36,-779.88,17.32,2.84 },
	{ -1196.58,-778.54,17.32,34.02 },
	{ -1447.79,-240.06,49.81,45.36 },
	{ -0.1,6511.82,31.88,306.15 },
	{ -2.59,6514.37,31.88,314.65 },
	{ 1691.49,4818.36,42.06,2.84 },
	{ 1688.14,4817.91,42.06,48.19 },
	{ 123.59,-211.01,54.56,215.44 },
	{ 122.92,-213.05,54.56,255.12 },
	{ 621.43,2752.0,42.09,53.86 },
	{ 621.29,2754.02,42.09,93.55 },
	{ 1200.66,2707.28,38.22,85.04 },
	{ 1200.76,2703.79,38.22,104.89 },
	{ -3171.91,1056.62,20.86,218.27 },
	{ -3172.65,1054.86,20.86,255.12 },
	{ -1096.5,2711.17,19.11,107.72 },
	{ -1094.1,2708.5,19.11,167.25 },
	{ 422.56,-810.34,29.49,19.85 },
	{ 419.13,-810.34,29.49,5.67 },
	{ 1324.96,-1650.8,52.27,138.9 },
	{ -1151.77,-1424.37,4.95,119.06 },
	{ 320.06,181.63,103.58,249.45 },
	{ -3171.12,1073.25,20.83,331.66 },
	{ -291.61,6200.25,31.48,257.96 },
	{ 1862.06,3748.13,33.03,62.37 },
	
	{ -821.9,-183.41,37.56,212.6 },
	{ 136.53,-1709.97,29.3,141.86 },
	{ -1284.48,-1118.02,7.0,94.97 },
	{ -1284.48,-1118.02,7.0,94.97 },
	{ 1210.51,-472.93,66.21,78.23 },
	{ -33.08,-150.54,57.08,346.45 },
	{ -279.99,6228.83,31.7,45.34 }
}
-----------------------------------------------------------------------------------------------------------------------------------------
-- THREADTARGET
-----------------------------------------------------------------------------------------------------------------------------------------
Citizen.CreateThread(function()
	for k,v in pairs(registers) do
		exports["vrp_target"]:AddCircleZone("register:"..k,vector3(v[1],v[2],v[3]),1.0,{
			name = "register:"..k,
			heading = v[4]
		},{
			shop = k,
			distance = 1.0,
			options = {
				{
					event = "register:openSystem",
					label = "Roubar",
					tunnel = "shop"
				}
			}
		})
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- REGISTER:OPENSYSTEM
-----------------------------------------------------------------------------------------------------------------------------------------
AddEventHandler("register:openSystem",function(shopId)
	if vSERVER.applyTimers(shopId) then
		SetEntityHeading(ped,registers[shopId][4])
		SetEntityCoords(ped,registers[shopId][1],registers[shopId][2],registers[shopId][3] - 1,1,0,0,0)
		vRP.playAnim(false,{"oddjobs@shop_robbery@rob_till","loop"},true)

		if exports["vrp_taskbar"]:skillTest(7000, 4, 5) then
			if exports["vrp_taskbar"]:skillTest(6000, 5, 7) then
				if exports["vrp_taskbar"]:skillTest(3000, 5, 7) then
					if exports["vrp_taskbar"]:skillTest(2300, 5, 6) then
						vSERVER.paymentMethod(registers[shopId][5])
					end
				end
			end
		end
		vRP.removeObjects()
	end
end)